<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fourier’s Law Heat Flow Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f4f8fc;
}
header{
    background:#0b5ed7;
    color:white;
    text-align:center;
    padding:15px;
    font-size:22px;
}
.container{
    display:grid;
    grid-template-columns:1fr 1.5fr 1.5fr;
    gap:10px;
    padding:10px;
}
.panel{
    background:white;
    padding:12px;
    border-radius:8px;
}
input,select,button{
    width:100%;
    padding:6px;
    margin:5px 0;
}
button{
    background:#fd7e14;
    color:white;
    border:none;
    cursor:pointer;
    font-weight:bold;
}
button:hover{
    background:#e36b0a;
}
canvas{
    background:white;
}
.small{
    font-size:13px;
    color:#555;
}
</style>
</head>

<body>

<header>Fourier’s Law Heat Flow Calculator (Pipe)</header>

<div class="container">

<!-- INPUT PANEL -->
<div class="panel">
<h3>Input Parameters</h3>

Inner Radius:
<input id="r1" type="number" value="5">
<select id="r1unit">
<option value="0.01">cm</option>
<option value="1">m</option>
</select>

Outer Radius:
<input id="r2" type="number" value="7">
<select id="r2unit">
<option value="0.01">cm</option>
<option value="1">m</option>
</select>

Inner Temperature (°C):
<input id="T1" type="number" value="200">

Outer Temperature (°C):
<input id="T2" type="number" value="50">

Thermal Conductivity (W/m·K):
<input id="k" type="number" value="45">

Pipe Length:
<input id="L" type="number" value="1">
<select id="Lunit">
<option value="1">m</option>
<option value="0.01">cm</option>
</select>

Time (seconds):
<input id="time" type="number" value="60">

Output Unit:
<select id="outunit">
<option value="W">Watt</option>
<option value="cal">cal/sec</option>
</select>

<button onclick="calculate()">Calculate</button>
<button onclick="resetAll()">Reset</button>
</div>

<!-- DIAGRAM -->
<div class="panel">
<h3>Pipe Cross-Section Diagram</h3>
<canvas id="pipeCanvas" width="350" height="350"></canvas>
<p class="small">Non-interactive cross-section (engineering representation)</p>
</div>

<!-- RESULTS -->
<div class="panel">
<h3>Results</h3>
<div id="results"></div>

<h4>Temperature vs Radius</h4>
<canvas id="tempChart"></canvas>

<h4>Heat Flow vs Time</h4>
<canvas id="timeChart"></canvas>
</div>

</div>

<div class="panel" style="margin:10px;">
<h3>How to Use</h3>
<ul>
<li>Enter pipe dimensions and temperatures</li>
<li>Choose correct units</li>
<li>Click <b>Calculate</b></li>
<li>Diagram and graphs update automatically</li>
</ul>
</div>

<script>
let tempChart, timeChart;

function drawPipeDiagram(r1, r2) {
    const canvas = document.getElementById("pipeCanvas");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0,0,canvas.width,canvas.height);

    const cx = canvas.width/2;
    const cy = canvas.height/2;
    const scale = 120 / r2;

    const R2 = r2 * scale;
    const R1 = r1 * scale;

    ctx.beginPath();
    ctx.arc(cx, cy, R2, 0, 2*Math.PI);
    ctx.fillStyle = "#ffccbc";
    ctx.fill();

    ctx.beginPath();
    ctx.arc(cx, cy, R1, 0, 2*Math.PI);
    ctx.fillStyle = "#ffffff";
    ctx.fill();

    ctx.strokeStyle="#000";
    ctx.stroke();

    ctx.fillStyle="#000";
    ctx.font="14px Arial";
    ctx.fillText("Outer Radius = " + r2.toFixed(3) + " m", cx - R2, cy - R2 - 10);
    ctx.fillText("Inner Radius = " + r1.toFixed(3) + " m", cx - R1, cy + 15);
}

function calculate(){
    const r1 = document.getElementById("r1").value * document.getElementById("r1unit").value;
    const r2 = document.getElementById("r2").value * document.getElementById("r2unit").value;
    const T1 = Number(document.getElementById("T1").value);
    const T2 = Number(document.getElementById("T2").value);
    const k = Number(document.getElementById("k").value);
    const L = document.getElementById("L").value * document.getElementById("Lunit").value;
    const time = Number(document.getElementById("time").value);
    const unit = document.getElementById("outunit").value;

    const Q = (2*Math.PI*k*L*(T1-T2))/Math.log(r2/r1);

    let Qout = Q;
    let unitLabel = "W";

    if(unit==="cal"){
        Qout = Q/4.186;
        unitLabel = "cal/sec";
    }

    document.getElementById("results").innerHTML = `
<b>Heat Flow Rate:</b> ${Qout.toFixed(4)} ${unitLabel}<br>
<b>Total Heat Transferred:</b> ${(Qout*time).toFixed(4)}<br><br>
<b>Formula:</b><br>
Q = 2πkL(T₁ − T₂) / ln(r₂/r₁)
`;

    drawPipeDiagram(r1, r2);

    const rvals=[], tvals=[];
    for(let i=0;i<=20;i++){
        const r = r1 + (r2-r1)*i/20;
        const T = T1 - (T1-T2)*Math.log(r/r1)/Math.log(r2/r1);
        rvals.push(r.toFixed(4));
        tvals.push(T.toFixed(2));
    }

    if(tempChart) tempChart.destroy();
    tempChart = new Chart(document.getElementById("tempChart"),{
        type:'line',
        data:{labels:rvals,datasets:[{label:'Temperature (°C)',data:tvals}]}
    });

    const t=[], q=[];
    for(let i=0;i<=10;i++){
        t.push((i*time/10).toFixed(1));
        q.push(Qout);
    }

    if(timeChart) timeChart.destroy();
    timeChart = new Chart(document.getElementById("timeChart"),{
        type:'line',
        data:{labels:t,datasets:[{label:'Heat Flow',data:q}]}
    });
}

function resetAll(){
    document.getElementById("results").innerHTML="";
}
</script>

</body>
</html>
