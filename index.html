<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fourier’s Law Heat Flow Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Libraries -->
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f8fc;
    color: #222;
}
header {
    background: #0b5ed7;
    color: white;
    padding: 15px;
    text-align: center;
    font-size: 22px;
}
.container {
    display: grid;
    grid-template-columns: 1fr 2fr 2fr;
    gap: 10px;
    padding: 10px;
}
.panel {
    background: white;
    padding: 12px;
    border-radius: 8px;
}
input, select, button {
    width: 100%;
    padding: 6px;
    margin: 5px 0;
}
button {
    background: #fd7e14;
    border: none;
    color: white;
    font-weight: bold;
    cursor: pointer;
}
button:hover {
    background: #e36b0a;
}
canvas {
    background: #fff;
}
.result {
    font-size: 15px;
    margin-top: 8px;
}
h3 {
    margin-top: 0;
}
.small {
    font-size: 13px;
    color: #555;
}
</style>
</head>

<body>

<header>Fourier’s Law Heat Flow Calculator (Cylindrical Pipe)</header>

<div class="container">

<!-- INPUT PANEL -->
<div class="panel">
<h3>Input Parameters</h3>

Inner Radius:
<input id="r1" type="number" value="5">
<select id="r1unit"><option value="0.01">cm</option><option value="1">m</option></select>

Outer Radius:
<input id="r2" type="number" value="7">
<select id="r2unit"><option value="0.01">cm</option><option value="1">m</option></select>

Inner Temperature (°C):
<input id="T1" type="number" value="200">

Outer Temperature (°C):
<input id="T2" type="number" value="50">

Thermal Conductivity (W/m·K):
<input id="k" type="number" value="45">

Pipe Length:
<input id="L" type="number" value="1">
<select id="Lunit"><option value="1">m</option><option value="0.01">cm</option></select>

Time Duration (seconds):
<input id="time" type="number" value="60">

Output Unit:
<select id="outunit">
<option value="W">Watt</option>
<option value="cal">cal/sec</option>
</select>

<button onclick="calculate()">Calculate</button>
<button onclick="resetAll()">Reset</button>

</div>

<!-- 3D VIEW -->
<div class="panel">
<h3>3D Pipe Visualization</h3>
<div id="threeContainer" style="height:350px;"></div>
<p class="small">Rotate & zoom using mouse</p>
</div>

<!-- RESULTS -->
<div class="panel">
<h3>Results</h3>
<div id="results" class="result"></div>

<h4>Temperature Distribution</h4>
<canvas id="tempChart"></canvas>

<h4>Heat Flow vs Time</h4>
<canvas id="timeChart"></canvas>
</div>

</div>

<div class="panel" style="margin:10px;">
<h3>How to Use This Tool</h3>
<ul>
<li>Enter inner & outer radius of the pipe</li>
<li>Provide inner and outer temperatures</li>
<li>Select thermal conductivity of material</li>
<li>Click <b>Calculate</b> to view heat flow</li>
<li>3D model updates automatically</li>
</ul>
</div>

<script>
let scene, camera, renderer, controls, pipe;

function init3D() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(60, 1, 0.1, 1000);
    renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(350,350);
    document.getElementById("threeContainer").appendChild(renderer.domElement);

    controls = new THREE.OrbitControls(camera, renderer.domElement);
    camera.position.z = 15;

    const light = new THREE.PointLight(0xffffff,1);
    light.position.set(10,10,10);
    scene.add(light);

    animate();
}
function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene,camera);
}

function drawPipe(r1,r2,L) {
    if(pipe) scene.remove(pipe);
    const geometry = new THREE.CylinderGeometry(r2,r2,L,64,1,true);
    const material = new THREE.MeshStandardMaterial({
        color: 0xff4500,
        side: THREE.DoubleSide
    });
    pipe = new THREE.Mesh(geometry, material);
    scene.add(pipe);
}

let tempChart, timeChart;

function calculate() {
    const r1 = document.getElementById("r1").value * document.getElementById("r1unit").value;
    const r2 = document.getElementById("r2").value * document.getElementById("r2unit").value;
    const T1 = Number(document.getElementById("T1").value);
    const T2 = Number(document.getElementById("T2").value);
    const k = Number(document.getElementById("k").value);
    const L = document.getElementById("L").value * document.getElementById("Lunit").value;
    const time = Number(document.getElementById("time").value);
    const unit = document.getElementById("outunit").value;

    const Q = (2*Math.PI*k*L*(T1-T2))/Math.log(r2/r1);
    let Qout = Q;
    let unitLabel = "W";

    if(unit === "cal") {
        Qout = Q/4.186;
        unitLabel = "cal/sec";
    }

    document.getElementById("results").innerHTML = `
<b>Heat Flow Rate:</b> ${Qout.toFixed(3)} ${unitLabel}<br>
<b>Total Heat Transferred:</b> ${(Qout*time).toFixed(3)} ${unitLabel.replace("/sec","")}<br><br>
<b>Formula Used:</b><br>
Q = 2πkL(T₁−T₂) / ln(r₂/r₁)
`;

    drawPipe(r1*5,r2*5,L*5);

    const rvals=[], tvals=[];
    for(let i=0;i<=20;i++){
        const r = r1 + (r2-r1)*i/20;
        const T = T1 - (T1-T2)*Math.log(r/r1)/Math.log(r2/r1);
        rvals.push(r.toFixed(3));
        tvals.push(T.toFixed(2));
    }

    if(tempChart) tempChart.destroy();
    tempChart = new Chart(document.getElementById("tempChart"), {
        type:'line',
        data:{labels:rvals, datasets:[{label:'Temperature (°C)', data:tvals}]}
    });

    const t=[], q=[];
    for(let i=0;i<=10;i++){
        t.push(i*time/10);
        q.push(Qout);
    }
    if(timeChart) timeChart.destroy();
    timeChart = new Chart(document.getElementById("timeChart"), {
        type:'line',
        data:{labels:t, datasets:[{label:'Heat Flow', data:q}]}
    });
}

function resetAll(){
    document.getElementById("results").innerHTML="";
}

init3D();
</script>

</body>
</html>
